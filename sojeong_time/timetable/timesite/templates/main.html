{% load static %}

<html>
  <head>
    <meta charset="utf-8" />
    <title>login</title>

    <link rel="stylesheet" type="text/css" href="{% static 'style_signup.css' %}" />

    <script src="{% static 'jquery-3.5.1.min.js' %}"></script>
    <script src="{% static 'bootstrap.min.js' %}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
      var determine = [];
      var flag = [];
      var i = 1;
      var bag_counts = 0;
      var count = [];
      var day1 = [];
      var start_timeh1 = [];
      var start_timem1 = [];
      var finish_timeh1 = [];
      var finish_timem1 = [];
      var day2 = [];
      var start_timeh2 = [];
      var start_timem2 = [];
      var finish_timeh2 = [];
      var finish_timem2 = [];
      var day3 = [];
      var start_timeh3 = [];
      var start_timem3 = [];
      var finish_timeh3 = [];
      var finish_timem3 = [];

      function determines(e) {
        if (determine[e.value] === 0 || determine[e.value] === undefined) {
          if (e.text != "Select") {
            flag[e.value] = e.text;
            count[e.value] = $("#subject option:selected").attr("value2");
            document.getElementById("result").innerText +=
              i + "." + e.text + "\r\n";
            rect(e.value);

            e.text = flag[e.value] + "(삭제)";
            determine[e.value] = 1;

            $("#subject option:eq(0)").prop("selected", true);
            $("#subject option:selected").text();

            i = i + 1;
          }
        } else if (determine[e.value] === 1) {
          var aa = document.getElementById("result");
          while (aa.firstChild) {
            aa.removeChild(aa.firstChild);
          }
          e.text = flag[e.value];
          determine[e.value] = 0;
          document.getElementById("result").innerText += "장바구니\n";
          var j;
          var k = 1;
          clean();
          for (j = 1; j < 200; j++) {
            if (determine[j] === 1) {
              document.getElementById("result").innerText +=
                k + "." + flag[j] + "\r\n";
              k++;
              rect(j);
            }
          }
          i = i - 1;
          $("#subject option:eq(0)").prop("selected", true);
          $("#subject option:selected").text();
        }
      }

      // function empty() {
      //   var ctx = document.getElementById("myCanvas").getContext("2d");
      //   ctx.fillStyle = "rgb(232, 232, 245)";
      //   ctx.clearRect(0, 0, 600, 480);
      //   var aa = document.getElementById("result");
      //   while (aa.firstChild) {
      //     aa.removeChild(aa.firstChild);
      //   }
      //   i = 1;
      //   document.getElementById("result").innerText += "장바구니\n";

      //   e.text = flag[e.value];
      //   determine[e.value] = 0;

      //   for (j = 1; j < 200; j++) {
      //     if (determine[j] === 1) {
      //       determine[j] = 0;

      //       $("#subject option:eq(" + j + ")").text = flag[j];
      //     }
      //   }
      // }

      function clean() {
        var ctx = document.getElementById("myCanvas").getContext("2d");

        ctx.fillStyle = "rgb(232, 232, 245)";
        ctx.clearRect(0, 0, 600, 480);
      }

      function rect(a) {
        var Acolor = new Array(
          "#75ca87",
          "#70a5e9",
          "#f08676",
          "#ecc369",
          "#a6c96f",
          "#7ad1c0",
          "#d397ed",
          "#9d86e0"
        );

        var holizantal = 30;
        var vertical = 6;
        day1[a] = $("#subject option:selected").attr("value3");

        start_timeh1[a] = $("#subject option:selected").attr("value4");
        start_timem1[a] = $("#subject option:selected").attr("value5");
        finish_timeh1[a] = $("#subject option:selected").attr("value6");
        finish_timem1[a] = $("#subject option:selected").attr("value7");
        day2[a] = $("#subject option:selected").attr("value8");
        start_timeh2[a] = $("#subject option:selected").attr("value9");
        start_timem2[a] = $("#subject option:selected").attr("value10");
        finish_timeh2[a] = $("#subject option:selected").attr("value11");
        finish_timem2[a] = $("#subject option:selected").attr("value12");
        day3[a] = $("#subject option:selected").attr("value13");
        start_timeh3[a] = $("#subject option:selected").attr("value14");
        start_timem3[a] = $("#subject option:selected").attr("value15");
        finish_timeh3[a] = $("#subject option:selected").attr("value16");
        finish_timem3[a] = $("#subject option:selected").attr("value17");
        var ctx = document.getElementById("myCanvas").getContext("2d");

        if (day1[a] === "월") {
          day1[a] = 1;
        } else if (day1[a] === "화") {
          day1[a]= 2;
        } else if (day1[a] === "수") {
          day1[a] = 3;
        } else if (day1[a] === "목") {
          day1[a]= 4;
        } else {
          day1[a] = 5;
        }
        if (day2[a] === "월") {
          day2[a] = 1;
        } else if (day2[a] === "화") {
          day2[a] = 2;
        } else if (day2[a] === "수") {
          day2[a]= 3;
        } else if (day2[a] === "목") {
          day2[a]= 4;
        } else {
          day2[a] = 5;
        }
        if (day3[a] === "월") {
          day3[a] = 1;
        } else if (day3[a] === "화") {
          day3[a] = 2;
        } else if (day3[a] === "수") {
          day3[a] = 3;
        } else if (day3[a] === "목") {
          day3[a]= 4;
        } else {
          day3[a] = 5;
        }

        var s_time = 0;
        var f_time = 0;

        var color = Acolor[bag_counts % 8];

        s_time = (start_timeh1[a] - 9) * 2 + start_timem1[a] / 30 + 1;

        f_time = (finish_timeh1[a] - 9) * 2 + finish_timem1[a] / 30 + 1;

        ctx.fillStyle = color;
        ctx.fillRect(100 * day1[a], 20 * s_time, 100, 20 * (f_time - s_time));

        if (count[a] > 1) {
          s_time = (start_timeh2[a] - 9) * 2 + start_timem2[a] / 30 + 1;
          f_time = (finish_timeh2[a] - 9) * 2 + finish_timem2[a] / 30 + 1;
          ctx.fillStyle = color;
          ctx.fillRect(100 * day2[a], 20 * s_time, 100, 20 * (f_time - s_time));
        }

        if (count[a] > 2) {
          s_time = (start_timeh3[a] - 9) * 2 + start_timem3[a] / 30 + 1;

          f_time = (finish_timeh3[a] - 9) * 2 + finish_timem3[a] / 30 + 1;

          ctx.fillStyle = color;
          ctx.fillRect(100 * day3[a], 20 * s_time, 100, 20 * (f_time - s_time));
        }
        bag_counts++;
      }
    </script>

  </head>

  <body>

    <div class="line">
      <div>&nbsp</div>
      <div id="login_back">
        <canvas id="myCanvas" width="600" height="480"> </canvas>
        <table width="600" height="480" style="color: #121212">
          <tr width="10%">
            <th id="table0_0"></th>
            <th id="table0_1">월</th>
            <th id="table0_2">화</th>
            <th id="table0_3">수</th>
            <th id="table0_4">목</th>
            <th id="table0_5">금</th>
          </tr>
          <tr>
            <th id="table2_0">9:00</th>
            <td id="table2_1"></td>
            <td id="table2_2"></td>
            <td id="table2_3"></td>
            <td id="table2_4"></td>
            <td id="table2_5"></td>
          </tr>
          <tr>
            <th id="table3_0">9:30</th>
            <td id="table3_1"></td>
            <td id="table3_2"></td>
            <td id="table3_3"></td>
            <td id="table3_4"></td>
            <td id="table3_5"></td>
          </tr>
          <tr>
            <th id="table4_0">10:00</th>
            <td id="table4_1"></td>
            <td id="table4_2"></td>
            <td id="table4_3"></td>
            <td id="table4_4"></td>
            <td id="table4_5"></td>
          </tr>
          <tr>
            <th id="table6_0">10:30</th>
            <td id="table6_1"></td>
            <td id="table6_2"></td>
            <td id="table6_3"></td>
            <td id="table6_4"></td>
            <td id="table6_5"></td>
          </tr>
          <tr>
            <th id="table7_0">11:00</th>
            <td id="table7_1"></td>
            <td id="table7_2"></td>
            <td id="table7_3"></td>
            <td id="table7_4"></td>
            <td id="table7_5"></td>
          </tr>
          <tr>
            <th id="table5_0">11:30</th>
            <td id="table5_1"></td>
            <td id="table5_2"></td>
            <td id="table5_3"></td>
            <td id="table5_4"></td>
            <td id="table5_5"></td>
          </tr>
          <tr>
            <th id="table6_0">12:00</th>
            <td id="table6_1"></td>
            <td id="table6_2"></td>
            <td id="table6_3"></td>
            <td id="table6_4"></td>
            <td id="table6_5"></td>
          </tr>
          <tr>
            <th id="table7_0">12:30</th>
            <td id="table7_1"></td>
            <td id="table7_2"></td>
            <td id="table7_3"></td>
            <td id="table7_4"></td>
            <td id="table7_5"></td>
          </tr>
          <tr>
            <th id="table8_0">1:00</th>
            <td id="table8_1"></td>
            <td id="table8_2"></td>
            <td id="table8_3"></td>
            <td id="table8_4"></td>
            <td id="table8_5"></td>
          </tr>
          <tr>
            <th id="table9_0">1:30</th>
            <td id="table9_1"></td>
            <td id="table9_2"></td>
            <td id="table9_3"></td>
            <td id="table9_4"></td>
            <td id="table9_5"></td>
          </tr>
          <tr>
            <th id="table10_0">2:00</th>
            <td id="table10_1"></td>
            <td id="table10_2"></td>
            <td id="table10_3"></td>
            <td id="table10_4"></td>
            <td id="table10_5"></td>
          </tr>
          <tr>
            <th id="table11_0">2:30</th>
            <td id="table11_1"></td>
            <td id="table11_2"></td>
            <td id="table11_3"></td>
            <td id="table11_4"></td>
            <td id="table11_5"></td>
          </tr>
          <tr>
            <th id="table12_0">3:00</th>
            <td id="table12_1"></td>
            <td id="table12_2"></td>
            <td id="table12_3"></td>
            <td id="table12_4"></td>
            <td id="table12_5"></td>
          </tr>
          <tr>
            <th id="table13_0">3:30</th>
            <td id="table13_1"></td>
            <td id="table13_2"></td>
            <td id="table13_3"></td>
            <td id="table13_4"></td>
            <td id="table13_5"></td>
          </tr>
          <tr>
            <th id="table14_0">4:00</th>
            <td id="table14_1"></td>
            <td id="table14_2"></td>
            <td id="table14_3"></td>
            <td id="table14_4"></td>
            <td id="table14_5"></td>
          </tr>
          <tr>
            <th id="table15_0">4:30</th>
            <td id="table15_1"></td>
            <td id="table15_2"></td>
            <td id="table15_3"></td>
            <td id="table15_4"></td>
            <td id="table15_5"></td>
          </tr>
          <tr>
            <th id="table16_0">5:00</th>
            <td id="table16_1"></td>
            <td id="table16_2"></td>
            <td id="table16_3"></td>
            <td id="table16_4"></td>
            <td id="table16_5"></td>
          </tr>
          <tr>
            <th id="table17_0">5:30</th>
            <td id="table17_1"></td>
            <td id="table17_2"></td>
            <td id="table17_3"></td>
            <td id="table17_4"></td>
            <td id="table17_5"></td>
          </tr>
          <tr>
            <th id="table18_0">6:00</th>
            <td id="table18_1"></td>
            <td id="table18_2"></td>
            <td id="table18_3"></td>
            <td id="table18_4"></td>
            <td id="table18_5"></td>
          </tr>
          <tr>
            <th id="table19_0">6:30</th>
            <td id="table19_1"></td>
            <td id="table19_2"></td>
            <td id="table19_3"></td>
            <td id="table19_4"></td>
            <td id="table19_5"></td>
          </tr>
          <tr>
            <th id="table20_0">7:00</th>
            <td id="table20_1"></td>
            <td id="table20_2"></td>
            <td id="table20_3"></td>
            <td id="table20_4"></td>
            <td id="table20_5"></td>
          </tr>
          <tr>
            <th id="table21_0">7:30</th>
            <td id="table21_1"></td>
            <td id="table21_2"></td>
            <td id="table21_3"></td>
            <td id="table21_4"></td>
            <td id="table21_5"></td>
          </tr>
          <tr>
            <th id="table22_0">8:00</th>
            <td id="table22_1"></td>
            <td id="table22_2"></td>
            <td id="table22_3"></td>
            <td id="table22_4"></td>
            <td id="table22_5"></td>
          </tr>
        </table>

        <div id="signup_question">
          과목을 선택하시오
          <input
            class="delete"
            type="button"
            value="delete"
            onclick="empty()"
          />
        </div>
        <div id="signup_select">
          <select
            id="subject"
            name="subject"
            onchange="determines(this.options[this.selectedIndex])"
            class="selectpicker"
            data-libe-search="true"
          >
            <option value="none" id="invisible">Select</option>
            {% for subject in subject_list %}
            <option
                    value={{ subject.id }}
                    value2={{ subject.count }}
                    value3={{ subject.day1 }}
                    value4={{ subject.start_h1 }}
                    value5={{ subject.start_m1 }}
                    value6={{ subject.fin_h1 }}
                    value7={{ subject.fin_m1 }}
                    value8={{ subject.day2 }}
                    value9={{ subject.start_h2 }}
                    value10={{ subject.start_m2 }}
                    value11={{ subject.fin_h2 }}
                    value12={{ subject.fin_m2 }}
                    value13={{ subject.day3 }}
                    value14={{ subject.start_h3 }}
                    value15={{ subject.start_m3 }}
                    value16={{ subject.fin_h3 }}
                    value17={{ subject.fin_m3 }}
            >
              {{ subject.name }}
            </option>
            {% endfor %}

          </select>
        </div>
        <div id="result_back">
          <div id="result">
            장바구니
            <br />
          </div>
        </div>
      </div>
      <h2>MAIN</h2>
      <h3>장바구니</h3>
    {% for selected in selected_subject_list %}
    {{ selected.subject_selected_id }}
    {% endfor %}

      {% for subject in subject_list %}
      <li>
          {{subject.id}} {{ subject.name }}
          <button method="get" class="btn btn-primary"> <a href="{% url 'timetable:add' subject.id %}"> ADD </a> </button>
          <button method="get" class="btn btn-primary"> <a href="{% url 'timetable:del' subject.id %}"> DEL </a> </button>
      </li>
    {% endfor %}
    </ul>
      <div>&nbsp</div>
    </div>
  </body>

</html>